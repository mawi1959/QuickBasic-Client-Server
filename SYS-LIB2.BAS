'
'
'*=============================================================================*
'| File Id.  ............ SYS-LIB2.BAS                                         |
'| Author ............... Muawiya Abujubain COVENTRY GROUP LTD.                |
'|                                                                             |
'| Purpose  ............. This file includes routines that are called by       |
'|                        program SCR-CNFG.BAS.                                |
'*=============================================================================*
'
'
VIDEO.ERROR.ROUTINE:
	'
	' Trap the following errors, other wise give error message and ABORT :-
	'
	'    5 = Illegal function call
	'
	ERROR.CODE = ERR
	SELECT CASE ERROR.CODE
	   CASE 5
	      RESUME NEXT
	   CASE ELSE
	      CLOSE
              OPEN "ERR-MSGS.DAT" FOR RANDOM AS #1 LEN = 30
	      FIELD #1, 30 AS ERROR.MESSAGE$
	      GET #1, ERROR.CODE
	      SCREEN , , 0, 0
	      COLOR 15, BGCLR
	      CLS
	      PRINT "ERROR = "; ERROR.CODE
	      PRINT "ERROR MESSAGE = "; ERROR.MESSAGE$
	      PRINT "Error occured in routine "; ERR.ROUTINE$
	      CLOSE
	      END
	END SELECT

SUB ANALIZE.COLOR (RA$)

	IF LEFT$(RA$, 2) = "H." THEN
	   RA$ = "High Intensity " + RIGHT$(RA$, LEN(RA$) - 2)
	END IF

END SUB

SUB ARE.YOU.SURE
	COLOR 15, 4
	LOCATE 17, 27, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 18, 27, 0: PRINT "º  Are you sure (Y/N) ?   º";
	LOCATE 19, 27, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(17, 27, 27, 3, "º")
END SUB

SUB AUTO.FILE (FILENUM, ERROR.CODE, ID$, PASSWORD$, LINE.COMMANDS$())

	IF ERROR.CODE = 53 THEN
	   ERROR.CODE = 0
	   CLOSE #FILENUM
	   OPEN "AUTOEXEC.CS" FOR OUTPUT AS FILENUM
	   PRINT #FILENUM, "[HOME]+LOGON+[ENTER]"
	   PRINT #FILENUM, "//////"
	   PRINT #FILENUM, "//////"
	   PRINT #FILENUM, "[END]+LOGOFF+[ENTER]"
	   CLOSE #FILENUM
	   FILENUM = FREEFILE
	   ERROR.CODE = 0
	   OPEN "AUTOEXEC.CS" FOR INPUT AS FILENUM
	END IF
	LINE INPUT #FILENUM, A$
	LINE INPUT #FILENUM, ID$
	LINE INPUT #FILENUM, PASSWORD$
	CALL INCRIPT.DECRIPT(ID$)
	CALL INCRIPT.DECRIPT(PASSWORD$)
	LINE.COUNT = 0
	DO UNTIL EOF(FILENUM)
	   LINE INPUT #FILENUM, A$
	   X = INSTR(A$, "LOGOFF")
	   IF X = 0 THEN
	      LINE.COUNT = LINE.COUNT + 1
	      LINE.COMMANDS$(LINE.COUNT) = A$
	   END IF
	LOOP
	CLOSE #FILENUM
END SUB

SUB AUTO.START.MESSAGE (CMD$)

	COLOR 15, 5
	LOCATE 12, 11, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·";
	LOCATE 13, 11, 0: PRINT "º You can configure up to 12 lines for the AutoStart file.  º";
	LOCATE 14, 11, 0: PRINT "º The function key  number reflects  the line number.  For  º";
	LOCATE 15, 11, 0: PRINT "º example  F1 = line 1  and  F2 = line 2  and so on. So to  º";
	LOCATE 16, 11, 0: PRINT "º configure line 12 press F12.                              º";
	LOCATE 17, 11, 0: PRINT "º                                                           º";
	LOCATE 18, 11, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½";
	CALL PUT.SHADOW(12, 11, 61, 7, "º")

	IF CMD$ = "P" OR CMD$ = "" THEN
	   LOCATE 16, 42, 0
	   PRINT "To change your password press";
	   LOCATE 17, 38, 0
	   PRINT "ALT-P.";
	END IF
END SUB

SUB COLORS.ROUTINE (LA$, RA$, COLOR.INDEX, STORED.COLORS$(), BACKGROUND$, FOREGROUND$, INPUT.FIELDS$, BLINK$, DIM$, DISPLAY.MODE$)
	SELECT CASE LA$
	    CASE "BACKGROUND"
	       BACKGROUND$ = RA$
	       CALL ANALIZE.COLOR(RA$)
	       LOCATE 12, 28, 0
	       PRINT RA$;
	       COLOR.INDEX = COLOR.INDEX + 1
	       STORED.COLORS$(COLOR.INDEX) = RA$
	    CASE "NORMAL"
	       FOREGROUND$ = RA$
	       CALL ANALIZE.COLOR(RA$)
	       LOCATE 13, 28, 0
	       PRINT RA$;
	       COLOR.INDEX = COLOR.INDEX + 1
	       STORED.COLORS$(COLOR.INDEX) = RA$
	    CASE "UNPROTECTED"
	       INPUT.FIELDS$ = RA$
	       CALL ANALIZE.COLOR(RA$)
	       LOCATE 14, 28, 0
	       PRINT RA$;
	       COLOR.INDEX = COLOR.INDEX + 1
	       STORED.COLORS$(COLOR.INDEX) = RA$
	    CASE "BLINK"
	       BLINK$ = RA$
	       CALL ANALIZE.COLOR(RA$)
	       LOCATE 15, 28, 0
	       PRINT RA$;
	       COLOR.INDEX = COLOR.INDEX + 1
	       STORED.COLORS$(COLOR.INDEX) = RA$
	    CASE "DIM"
	       DIM$ = RA$
	       CALL ANALIZE.COLOR(RA$)
	       LOCATE 16, 28, 0
	       PRINT RA$;
	       COLOR.INDEX = COLOR.INDEX + 1
	       STORED.COLORS$(COLOR.INDEX) = RA$
	    CASE "DISP.MODE"
	       DIM$ = RA$
	       CALL ANALIZE.COLOR(RA$)
	       LOCATE 18, 28, 0
	       PRINT RA$;
	       DISPLAY.MODE$ = RA$
	END SELECT
END SUB

SUB COMMS.ROUTINE (LA$, RA$, PORT$, SPEED$, PARITY$, DATA.SIZE$, STOP.BITS$, PRN.PORT$, PRN.ENABLE$, PRN.DISABLE$, CMD$, P.SPEED$, P.DATA$, P.PARITY$, P.STOP$, CMDL, TIME.OUT$)
	SELECT CASE LA$
	   CASE "PORT"
	      PORT$ = LEFT$(RA$, 4)
	      LOCATE 10, 23, 0
	      PRINT PORT$;
	      RA$ = RIGHT$(RA$, LEN(RA$) - 5)
	      COMMA = INSTR(RA$, ",")
	      SPEED$ = LEFT$(RA$, COMMA - 1)
	      LOCATE 11, 23, 0
	      PRINT SPEED$;
	      RA$ = RIGHT$(RA$, LEN(RA$) - COMMA)
	      COMMA = INSTR(RA$, ",")
	      PARITY$ = LEFT$(RA$, COMMA - 1)
	      SELECT CASE PARITY$
		 CASE "N"
		    PARITY$ = "NONE"
		 CASE "O"
		    PARITY$ = "ODD"
		 CASE "E"
		    PARITY$ = "EVEN"
	      END SELECT
	      LOCATE 13, 23, 0
	      PRINT PARITY$;
	      RA$ = RIGHT$(RA$, LEN(RA$) - COMMA)
	      COMMA = INSTR(RA$, ",")
	      DATA.SIZE$ = LEFT$(RA$, COMMA - 1)
	      LOCATE 12, 23, 0
	      PRINT DATA.SIZE$;
	      RA$ = RIGHT$(RA$, LEN(RA$) - COMMA)
	      STOP.BITS$ = RA$
	      LOCATE 14, 23, 0
	      PRINT STOP.BITS$;
	   CASE "TIME.OUT"
	      TIME.OUT$ = RA$
	      LOCATE 15, 23, 0
	      PRINT RA$;
	   CASE "PRN.ENABLE"
	      PRN.ENABLE$ = RA$
	      IF CMD$ <> "2" THEN
		 LOCATE 17, 32, 0
		 PRINT RA$;
	      END IF
	   CASE "PRN.DISABLE"
	      PRN.DISABLE$ = RA$
	      IF CMD$ <> "2" THEN
		 LOCATE 18, 32, 0
		 PRINT RA$;
	      END IF
	   CASE "PRN.PORT"
	      IF LEFT$(RA$, 3) <> "COM" THEN
		 PRN.PORT$ = RA$
		 P.SPEED$ = ""
		 P.PARITY$ = ""
		 P.DATA$ = ""
		 P.STOP$ = ""
	      ELSE
		 PRN.PORT$ = LEFT$(RA$, 4)
		 RA$ = RIGHT$(RA$, LEN(RA$) - 5)
		 COMMA = INSTR(RA$, ",")
		 P.SPEED$ = LEFT$(RA$, COMMA - 1)
		 RA$ = RIGHT$(RA$, LEN(RA$) - COMMA)
		 COMMA = INSTR(RA$, ",")
		 P.PARITY$ = LEFT$(RA$, COMMA - 1)
		 RA$ = RIGHT$(RA$, LEN(RA$) - COMMA)
		 COMMA = INSTR(RA$, ",")
		 P.DATA$ = LEFT$(RA$, COMMA - 1)
		 RA$ = RIGHT$(RA$, LEN(RA$) - COMMA)
		 P.STOP$ = RA$
	      END IF
	      IF CMD$ <> "2" THEN
		 LOCATE 19, 32, 0: PRINT PRN.PORT$;
		 IF LEFT$(PRN.PORT$, 3) = "COM" THEN
		    LOCATE 19, 37, 0: PRINT "Speed       Data   Parity   Stop";
		    IF P.SPEED$ = "" THEN P.SPEED$ = "9600"
		    IF P.PARITY$ = "" THEN P.PARITY$ = "O"
		    IF P.DATA$ = "" THEN P.DATA$ = "8"
		    IF P.STOP$ = "" THEN P.STOP$ = "1"
		    LOCATE 19, 43, 0: PRINT P.SPEED$;
		    LOCATE 19, 63, 0: PRINT P.PARITY$;
		    LOCATE 19, 54, 0: PRINT P.DATA$;
		    LOCATE 19, 70, 0: PRINT P.STOP$;
		    CMDL = 13
		 ELSE
		    CMDL = 9
		 END IF
	      ELSE
                 CMDL = 6
	      END IF
	END SELECT
END SUB

SUB CREATE.DEFAULT.FILE

	OPEN "SCR-MNGR.INI" FOR OUTPUT AS #1
	PRINT #1, "*"
	PRINT #1, "*       AVAILABLE COLORS"
	PRINT #1, "*       ================"
	PRINT #1, "*"
	PRINT #1, "*    BLACK - BLUE - GREEN - CYAN"
	PRINT #1, "*    RED - MAGENTA - BROWN - WHITE"
	PRINT #1, "*"
	PRINT #1, "*      HIGH INTENSITY COLORS"
	PRINT #1, "*      ====================="
	PRINT #1, "*"
	PRINT #1, "*    H.BLACK - H.BLUE - H.GREEN - H.CYAN"
	PRINT #1, "*    H.RED - H.MAGENTA - H.BROWN - H.WHITE"
	PRINT #1, "*"
	PRINT #1, "BACKGROUND  = H.MAGENTA"
	PRINT #1, "NORMAL      = H.WHITE"
	PRINT #1, "UNPROTECTED = H.BROWN"
	PRINT #1, "BLINK       = H.CYAN"
	PRINT #1, "DIM         = H.RED"
	PRINT #1, "DISP.MODE   = BLOCK"
	PRINT #1, "PORT        = COM1:9600,N,8,1"
	PRINT #1, "TIME.OUT    = 30"
	PRINT #1, "PRN.PORT    = COM2:9600,N,8,1"
	PRINT #1, "PRN.ENABLE  = 0D"
	PRINT #1, "PRN.DISABLE = 0D"
	PRINT #1, "RAM.DRIVE   = D:"
	PRINT #1, "MIN.SPACE   = 100"
	PRINT #1, "EXT.DRIVE   = C:"
	PRINT #1, "EXT.MIN.SP  = 9999"
	PRINT #1, "REFRESH     = 5"
	PRINT #1, "EXT.ENABLE  = Y"
	PRINT #1, "*"
	PRINT #1, "*    FUNCTION KEY DEFINITIONS."
	PRINT #1, "*"
	PRINT #1, "*            #F1 means SHIFT F1"
	PRINT #1, "*            ^F1 means CTRL  F1"
	PRINT #1, "*            @F1 means ALT   F1"
	PRINT #1, "*"
	PRINT #1, "F1         ="
	PRINT #1, "F2         ="
	PRINT #1, "F3         ="
	PRINT #1, "F4         ="
	PRINT #1, "F5         ="
	PRINT #1, "F6         ="
	PRINT #1, "F7         ="
	PRINT #1, "F8         ="
	PRINT #1, "F9         ="
	PRINT #1, "F10        ="
	PRINT #1, "F11        ="
	PRINT #1, "F12        ="
	PRINT #1, "#F1        ="
	PRINT #1, "#F2        ="
	PRINT #1, "#F3        ="
	PRINT #1, "#F4        ="
	PRINT #1, "#F5        ="
	PRINT #1, "#F6        ="
	PRINT #1, "#F7        ="
	PRINT #1, "#F8        ="
	PRINT #1, "#F9        ="
	PRINT #1, "#F10       ="
	PRINT #1, "#F11       ="
	PRINT #1, "#F12       ="
	PRINT #1, "^F1        ="
	PRINT #1, "^F2        ="
	PRINT #1, "^F3        ="
	PRINT #1, "^F4        ="
	PRINT #1, "^F5        ="
	PRINT #1, "^F6        ="
	PRINT #1, "^F7        ="
	PRINT #1, "^F8        ="
	PRINT #1, "^F9        ="
	PRINT #1, "^F10       ="
	PRINT #1, "^F11       ="
	PRINT #1, "^F12       ="
	PRINT #1, "@F1        ="
	PRINT #1, "@F2        ="
	PRINT #1, "@F3        ="
	PRINT #1, "@F4        ="
	PRINT #1, "@F5        ="
	PRINT #1, "@F6        ="
	PRINT #1, "@F7        ="
	PRINT #1, "@F8        ="
	PRINT #1, "@F9        ="
	PRINT #1, "@F10       ="
	PRINT #1, "@F11       ="
	PRINT #1, "@F12       ="
	CLOSE #1
END SUB

SUB DATA.SIZE.WINDOW
	LOCATE 10, 47, 0: PRINT "ÚÄDataSizeÄ¿";
	LOCATE 11, 47, 0: PRINT "³          ³";
	LOCATE 12, 47, 0: PRINT "³          ³";
	LOCATE 13, 47, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(10, 47, 12, 4, "³")
END SUB

SUB DISPLAY.AFKEYS.MESSAGE

	CALL DISPLAY.FKEYS.WINDOW
	LOCATE 15, 19, 0: PRINT "³            ALT-F1 - ALT-F12            ³";
END SUB

SUB DISPLAY.CFKEYS.MESSAGE

	CALL DISPLAY.FKEYS.WINDOW
	LOCATE 15, 19, 0: PRINT "³           CTRL-F1 - CTRL-F12           ³";
END SUB

SUB DISPLAY.COLORS.SCREEN

        COLOR 15, 6

	LOCATE 7, 6, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·"
	LOCATE 8, 6, 0: PRINT "º                      Client Screen Manager                       º"
	LOCATE 9, 6, 0: PRINT "º                         Screen Options                           º"
	LOCATE 10, 6, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶"
	LOCATE 11, 6, 0: PRINT "º    Colors                                                        º"
	LOCATE 12, 6, 0: PRINT "º       Background                                                 º"
	LOCATE 13, 6, 0: PRINT "º       Foreground                                                 º"
	LOCATE 14, 6, 0: PRINT "º       Input Fields                                               º"
	LOCATE 15, 6, 0: PRINT "º       Blink                                                      º"
	LOCATE 16, 6, 0: PRINT "º       Dim                                                        º"
	LOCATE 17, 6, 0: PRINT "º                                                                  º"
	LOCATE 18, 6, 0: PRINT "º    Display Mode                                                  º"
	LOCATE 19, 6, 0: PRINT "º                                                                  º"
	LOCATE 20, 6, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶"
	LOCATE 21, 6, 0: PRINT "º Space Bar - Choose Option    ÄÄÙ - Accept Option     ESC - Exit º"
	LOCATE 22, 6, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½"
	CALL PUT.SHADOW(7, 6, 68, 16, "º")
END SUB

SUB DISPLAY.COMMS.PARAM (I, PORT$, SPEED$, DATA.SIZE$, PARITY$, STOP.BITS$, PRN.PORT$, PRN.ENABLE$, PRN.DISABLE$, CMD$, P.SPEED$, P.DATA$, P.PARITY$, P.STOP$, CMDL, TIME.OUT$)
	SELECT CASE I
	   CASE 1
	      IF CMD$ <> "2" THEN
		 IF LEFT$(PRN.PORT$, 3) = "COM" THEN
		    COLOR 15, 1
		    LOCATE 19, 70, 0: PRINT P.STOP$;
		    LOCATE 19, 65, 0: PRINT "Stop";
		 ELSE
		    COLOR 15, 1
		    LOCATE 19, 32, 0: PRINT PRN.PORT$;
		    LOCATE 19, 14, 0: PRINT "Printer Port";
		 END IF
	      ELSE
		 COLOR 15, 1
                 LOCATE 15, 11, 0: PRINT "Time Out";
                 LOCATE 15, 23, 0: PRINT TIME.OUT$
	      END IF
	      COLOR 0, 3
	      LOCATE 10, 23, 0: PRINT PORT$;
	      COLOR 12, 1
	      LOCATE 10, 11, 0: PRINT "Port";
	   CASE 2
	      COLOR 15, 1
	      LOCATE 10, 11, 0: PRINT "Port";
	      LOCATE 10, 23, 0: PRINT PORT$;
	      COLOR 12, 1
	      LOCATE 11, 11, 0: PRINT "Speed";
	      COLOR 0, 3
	      LOCATE 11, 23, 0: PRINT SPEED$;
	   CASE 3
	      COLOR 15, 1
	      LOCATE 11, 11, 0: PRINT "Speed";
	      LOCATE 11, 23, 0: PRINT SPEED$;
	      COLOR 12, 1
	      LOCATE 12, 11, 0: PRINT "Data Size";
	      COLOR 0, 3
	      LOCATE 12, 23, 0: PRINT DATA.SIZE$;
	   CASE 4
	      COLOR 15, 1
	      LOCATE 12, 11, 0: PRINT "Data Size";
	      LOCATE 12, 23, 0: PRINT DATA.SIZE$;
	      COLOR 12, 1
	      LOCATE 13, 11, 0: PRINT "Parity";
	      COLOR 0, 3
	      LOCATE 13, 23, 0: PRINT PARITY$;
	   CASE 5
	      COLOR 15, 1
	      LOCATE 13, 11, 0: PRINT "Parity";
	      LOCATE 13, 23, 0: PRINT PARITY$;
	      COLOR 12, 1
	      LOCATE 14, 11, 0: PRINT "Stop Bits";
	      COLOR 0, 3
	      LOCATE 14, 23, 0: PRINT STOP.BITS$
	   CASE 6
	      COLOR 15, 1
	      LOCATE 14, 11, 0: PRINT "Stop Bits";
	      LOCATE 14, 23, 0: PRINT STOP.BITS$;
	      COLOR 12, 1
	      LOCATE 15, 11, 0: PRINT "Time Out";
	      COLOR 0, 3
	      LOCATE 15, 23, 0: PRINT TIME.OUT$;
	   CASE 7
	      COLOR 15, 1
	      LOCATE 15, 11, 0: PRINT "Time Out";
	      LOCATE 15, 23, 0: PRINT TIME.OUT$;
	      COLOR 12, 1
	      LOCATE 17, 14, 0: PRINT "Enable Printing";
	      COLOR 0, 3
	      LOCATE 17, 32, 0: PRINT PRN.ENABLE$;
	   CASE 8
	      COLOR 15, 1
	      LOCATE 17, 14, 0: PRINT "Enable Printing";
	      LOCATE 17, 32, 0: PRINT PRN.ENABLE$;
	      COLOR 12, 1
	      LOCATE 18, 14, 0: PRINT "Disable Printing";
	      COLOR 0, 3
	      LOCATE 18, 32, 0: PRINT PRN.DISABLE$;
	   CASE 9
	      COLOR 15, 1
	      LOCATE 18, 14, 0: PRINT "Disable Printing";
	      LOCATE 18, 32, 0: PRINT PRN.DISABLE$;
	      COLOR 12, 1
	      LOCATE 19, 14, 0: PRINT "Printer Port";
	      COLOR 0, 3
	      LOCATE 19, 32, 0: PRINT PRN.PORT$;
	   CASE 10
	      COLOR 15, 1
	      LOCATE 19, 14, 0: PRINT "Printer Port";
	      LOCATE 19, 32, 0: PRINT PRN.PORT$;
	      COLOR 12, 1
	      IF LEFT$(PRN.PORT$, 3) = "COM" THEN
		 LOCATE 19, 37, 0: PRINT "Speed";
		 COLOR 0, 3
		 LOCATE 19, 43, 0: PRINT P.SPEED$;
	      ELSE
		 LOCATE 10, 11, 0: PRINT "Port";
		 COLOR 0, 3
		 LOCATE 10, 23, 0: PRINT PORT$;
	      END IF
	   CASE 11
	      COLOR 15, 1
	      LOCATE 19, 37, 0: PRINT "Speed";
	      LOCATE 19, 43, 0: PRINT P.SPEED$
	      COLOR 12, 1
	      LOCATE 19, 49, 0: PRINT "Data";
	      COLOR 0, 3
	      LOCATE 19, 54, 0: PRINT P.DATA$;
	   CASE 12
	      COLOR 15, 1
	      LOCATE 19, 49, 0: PRINT "Data";
	      LOCATE 19, 54, 0: PRINT P.DATA$;
	      COLOR 12, 1
	      LOCATE 19, 56, 0: PRINT "Parity";
	      COLOR 0, 3
	      LOCATE 19, 63, 0: PRINT P.PARITY$;
	   CASE 13
	      COLOR 15, 1
	      LOCATE 19, 56, 0: PRINT "Parity";
	      LOCATE 19, 63, 0: PRINT P.PARITY$;
	      COLOR 12, 1
	      LOCATE 19, 65, 0: PRINT "Stop";
	      COLOR 0, 3
	      LOCATE 19, 70, 0: PRINT P.STOP$;
	   END SELECT
END SUB

SUB DISPLAY.COMMS.SCREEN (CMD$)

	COLOR 15, 1

	LOCATE 6, 6, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·"
	LOCATE 7, 6, 0: PRINT "º                      Client Screen Manager                       º"
	LOCATE 8, 6, 0: PRINT "º                Communications Parameters Configuration           º"
	LOCATE 9, 6, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶"
	LOCATE 10, 6, 0: PRINT "º    Port                                                          º"
	LOCATE 11, 6, 0: PRINT "º    Speed                                                         º"
	LOCATE 12, 6, 0: PRINT "º    Data Size                                                     º"
	LOCATE 13, 6, 0: PRINT "º    Parity                                                        º"
	LOCATE 14, 6, 0: PRINT "º    Stop Bits                                                     º"
	LOCATE 15, 6, 0: PRINT "º    Time Out                                                      º"
	LOCATE 16, 6, 0: PRINT "º                                                                  º"
	LOCATE 17, 6, 0: PRINT "º                                                                  º"
	LOCATE 18, 6, 0: PRINT "º                                                                  º"
	LOCATE 19, 6, 0: PRINT "º                                                                  º"
	LOCATE 20, 6, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶"
	LOCATE 21, 6, 0: PRINT "º Space Bar - Item Select      ÄÄÙ - Edit Item         ESC - Exit º"
	LOCATE 22, 6, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½"
	CALL PUT.SHADOW(6, 6, 68, 17, "º")
	IF CMD$ <> "2" THEN
	   LOCATE 16, 11, 0: PRINT "Printer Parameters :-";
	   LOCATE 17, 14, 0: PRINT "Enable Printing";
	   LOCATE 18, 14, 0: PRINT "Disable Printing";
	   LOCATE 19, 14, 0: PRINT "Printer Port";
	END IF

END SUB

SUB DISPLAY.EXTERNAL.DISK.SCREEN

	COLOR 15, 6

	LOCATE 7, 4, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·";
	LOCATE 8, 4, 0: PRINT "º                      Client Screen Manager                       º";
	LOCATE 9, 4, 0: PRINT "º               Disk Storage Parameters Configuration              º";
	LOCATE 10, 4, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶";
	LOCATE 11, 4, 0: PRINT "º External Drive Parameters                                        º";
	LOCATE 12, 4, 0: PRINT "º    Disk & Directory Id                                           º";
	LOCATE 13, 4, 0: PRINT "º    Minimum Space Allowed                                         º";
	LOCATE 14, 4, 0: PRINT "º    Refresh Frequency                                             º";
	LOCATE 15, 4, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶";
	LOCATE 16, 4, 0: PRINT "º                                                       ESC - Exit º";
	LOCATE 17, 4, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½";
	CALL PUT.SHADOW(7, 4, 68, 11, "º")

END SUB

SUB DISPLAY.FKEYS
	COLOR 0, 6
	LOCATE 3, 3, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·";
	LOCATE 4, 3, 0: PRINT "º                      Client Screen Manager                              º";
	LOCATE 5, 3, 0: PRINT "º                                                                         º";
	LOCATE 6, 3, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶";
	LOCATE 7, 3, 0: PRINT "º   Command 1                           Command 13                        º";
	LOCATE 8, 3, 0: PRINT "º   Command 2                           Command 14                        º";
	LOCATE 9, 3, 0: PRINT "º   Command 3                           Command 15                        º";
	LOCATE 10, 3, 0: PRINT "º   Command 4                           Command 16                        º";
	LOCATE 11, 3, 0: PRINT "º   Command 5                           Command 17                        º";
	LOCATE 12, 3, 0: PRINT "º   Command 6                           Command 18                        º";
	LOCATE 13, 3, 0: PRINT "º   Command 7                           Command 19                        º";
	LOCATE 14, 3, 0: PRINT "º   Command 8                           Command 20                        º";
	LOCATE 15, 3, 0: PRINT "º   Command 9                           Command 21                        º";
	LOCATE 16, 3, 0: PRINT "º   Command 10                          Command 22                        º";
	LOCATE 17, 3, 0: PRINT "º   Command 11                          Command 23                        º";
	LOCATE 18, 3, 0: PRINT "º   Command 12                          Command 24                        º";
	LOCATE 19, 3, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶";
	LOCATE 20, 3, 0: PRINT "º F1 [ENTER]  F5 [TAB]          F9  [SHOW KEYS]         ÄÙ Enter Text    º";
	LOCATE 21, 3, 0: PRINT "º F2 [HOME]   F6 [BACK TAB]     F10 [INITIALIZE FIELDS] DEL Delete Commandº";
	LOCATE 22, 3, 0: PRINT "º F3 [END]    F7 [SEND SCREEN]  F11 [CALCULATOR]        Esc Exit          º";
	LOCATE 23, 3, 0: PRINT "º F4 [HELP]   F8 [REACLL INPUT] F12 [CALCULATOR W/TRANSFER]                º";
	LOCATE 24, 3, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½";
	CALL PUT.SHADOW(3, 3, 75, 22, "º")
	COLOR 7, 6
	LOCATE 20, 5, 0: PRINT "F1";
	LOCATE 21, 5, 0: PRINT "F2";
	LOCATE 22, 5, 0: PRINT "F3";
	LOCATE 23, 5, 0: PRINT "F4";
	LOCATE 20, 17, 0: PRINT "F5";
	LOCATE 21, 17, 0: PRINT "F6";
	LOCATE 22, 17, 0: PRINT "F7";
	LOCATE 23, 17, 0: PRINT "F8";
	LOCATE 20, 35, 0: PRINT "F9";
	LOCATE 21, 35, 0: PRINT "F10";
	LOCATE 22, 35, 0: PRINT "F11";
	LOCATE 23, 35, 0: PRINT "F12";
	LOCATE 20, 59, 0: PRINT "ÄÙ";
	LOCATE 21, 59, 0: PRINT "DEL";
	LOCATE 22, 59, 0: PRINT "Esc";
END SUB

SUB DISPLAY.FKEYS.COMMANDS (MENU.SELECTION$, F4$, F5$, F6$, F7$, F8$, FKEYS.COMMANDS$(), AUTO.COMMANDS$())

	ROW = 7
	COLOR 15, 6
	SELECT CASE MENU.SELECTION$
	   CASE F4$, F5$, F6$, F7$
	      FOR I2 = 1 TO 12
		 LOCATE ROW, 18, 0
		 PRINT FKEYS.COMMANDS$(I2);
		 ROW = ROW + 1
	      NEXT I2
	      ROW = 7
	      FOR I2 = 13 TO 24
		 LOCATE ROW, 54, 0
		 PRINT FKEYS.COMMANDS$(I2);
		 ROW = ROW + 1
	      NEXT I2
	   CASE F8$
	      FOR I2 = 1 TO 12
		 LOCATE ROW, 18, 0
		 PRINT AUTO.COMMANDS$(I2);
		 ROW = ROW + 1
	      NEXT I2
	      ROW = 7
	      FOR I2 = 13 TO 24
		 LOCATE ROW, 54, 0
		 PRINT AUTO.COMMANDS$(I2);
		 ROW = ROW + 1
	      NEXT I2
	END SELECT

END SUB

SUB DISPLAY.FKEYS.MESSAGE

	CALL DISPLAY.FKEYS.WINDOW
	LOCATE 15, 19, 0: PRINT "³                F1 - F12                ³";
END SUB

SUB DISPLAY.FKEYS.WINDOW

	COLOR 15, 2
	LOCATE 13, 19, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 14, 19, 0: PRINT "³  Press the function key to be defined  ³";
	LOCATE 16, 19, 0: PRINT "³                   OR                   ³";
	LOCATE 17, 19, 0: PRINT "³               Esc to Exit              ³";
	LOCATE 18, 19, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(13, 19, 42, 6, "³")
END SUB

SUB DISPLAY.MENU

	COLOR 0, 3
	LOCATE 7, 19, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·"
	LOCATE 8, 19, 0: PRINT "º          Client Screen Manager          º"
	LOCATE 9, 19, 0: PRINT "º            Configuration Menu           º"
	LOCATE 10, 19, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶"
	LOCATE 11, 19, 0: PRINT "º          Screen Options                 º"
	LOCATE 12, 19, 0: PRINT "º          Communications                 º"
	LOCATE 13, 19, 0: PRINT "º          Disk Storage                   º"
	LOCATE 14, 19, 0: PRINT "º          Function Keys                  º"
	LOCATE 15, 19, 0: PRINT "º          SHIFT Function Keys            º"
	LOCATE 16, 19, 0: PRINT "º          CTRL Function Keys             º"
	LOCATE 17, 19, 0: PRINT "º          ALT Function Keys              º"
	LOCATE 18, 19, 0: PRINT "º          Auto Start Sequence            º"
	LOCATE 19, 19, 0: PRINT "º          Calculator Tax Setup           º"
	LOCATE 20, 19, 0: PRINT "º                                         º"
	LOCATE 21, 19, 0: PRINT "º          Exit                           º"
	LOCATE 22, 19, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½"
	CALL PUT.SHADOW(7, 19, 43, 16, "º")
	COLOR 15, 3
	LOCATE 11, 25, 0: PRINT "F1"
	LOCATE 12, 25, 0: PRINT "F2"
	LOCATE 13, 25, 0: PRINT "F3"
	LOCATE 14, 25, 0: PRINT "F4"
	LOCATE 15, 25, 0: PRINT "F5"
	LOCATE 16, 25, 0: PRINT "F6"
	LOCATE 17, 25, 0: PRINT "F7"
	LOCATE 18, 25, 0: PRINT "F8"
	LOCATE 19, 25, 0: PRINT "F9"
	LOCATE 21, 25, 0: PRINT "ESC"
END SUB

SUB DISPLAY.RAM.DISK.SCREEN

	COLOR 15, 1

	LOCATE 6, 6, 0: PRINT "ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·";
	LOCATE 7, 6, 0: PRINT "º                      Client Screen Manager                       º";
	LOCATE 8, 6, 0: PRINT "º               Disk Storage Parameters Configuration              º";
	LOCATE 9, 6, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶";
	LOCATE 10, 6, 0: PRINT "º Ram Drive Parameters                                             º";
	LOCATE 11, 6, 0: PRINT "º    Disk & Directory Id                                           º";
	LOCATE 12, 6, 0: PRINT "º    Minimum Space Allowed                                         º";
	LOCATE 13, 6, 0: PRINT "º                                                                  º";
	LOCATE 14, 6, 0: PRINT "º Use External Drive (Y/N) ?                                       º";
	LOCATE 15, 6, 0: PRINT "ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶";
	LOCATE 16, 6, 0: PRINT "º                                                       ESC - Exit º";
	LOCATE 17, 6, 0: PRINT "ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½";
	CALL PUT.SHADOW(6, 6, 68, 12, "º")

END SUB

SUB DISPLAY.SFKEYS.MESSAGE

	CALL DISPLAY.FKEYS.WINDOW
	LOCATE 15, 19, 0: PRINT "³           SHIFT-F1 - SHIFT-F12         ³";
END SUB

SUB INCRIPT.DECRIPT (T$)
	IF LEN(T$) < 6 THEN
	   T$ = T$ + SPACE$(6 - LEN(T$))
	END IF
	FOR J = 1 TO LEN(T$)
	   W$ = W$ + CHR$(ASC(MID$(T$, J, 1)) XOR 15)
	NEXT J
	T$ = W$
END SUB

SUB MESSAGE.1

	LOCATE 22, 6, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 23, 6, 0: PRINT "³ Space Bar - Item Select      ÄÄÙ - Accept Item       ESC - Exit ³";
	LOCATE 24, 6, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(22, 6, 68, 3, "³")
END SUB

SUB MESSAGE.10
	LOCATE 19, 14, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 20, 14, 0: PRINT "³ Enter the minimum space allowed for the external  ³";
	LOCATE 21, 14, 0: PRINT "³ drive in Kilo Bytes. The system will stop copying ³";
	LOCATE 22, 14, 0: PRINT "³ the new formats, to the external drive, after     ³";
	LOCATE 23, 14, 0: PRINT "³ reaching this number.                             ³";
	LOCATE 24, 14, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(19, 14, 53, 6, "³")
END SUB

SUB MESSAGE.11
	LOCATE 19, 14, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 20, 14, 0: PRINT "³ The system will copy all the new formats, from    ³";
	LOCATE 21, 14, 0: PRINT "³ RAM drive to the external drive, every time this  ³";
	LOCATE 22, 14, 0: PRINT "³ number of new formats have been received. Entering³";
	LOCATE 23, 14, 0: PRINT "³ 1 here causes the system to copy all the formats. ³";
	LOCATE 24, 14, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(19, 14, 53, 6, "³")
END SUB

SUB MESSAGE.12
        LOCATE 20, 15, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
        LOCATE 21, 15, 0: PRINT "³ The maximum number of seconds the system will   ³";
        LOCATE 22, 15, 0: PRINT "³ wait for a message before assuming that the     ³";
        LOCATE 23, 15, 0: PRINT "³ SERVER is disconnected.                         ³";
        LOCATE 24, 15, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
        CALL PUT.SHADOW(20, 15, 51, 5, "³")
END SUB

SUB MESSAGE.2
	LOCATE 20, 15, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 21, 15, 0: PRINT "³ Enter the escape sequence in HEX representation ³";
	LOCATE 22, 15, 0: PRINT "³ such as 0D0A0F1E - Press ÄÄÙ  when finished.   ³";
	LOCATE 23, 15, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(20, 15, 51, 4, "³")
END SUB

SUB MESSAGE.3
	LOCATE 19, 15, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 20, 15, 0: PRINT "³ Enter the drive id followed by the directory id.³";
	LOCATE 21, 15, 0: PRINT "³ A ':' has to follow the drive id. The directory ³";
	LOCATE 22, 15, 0: PRINT "³ id is optional.                                 ³";
	LOCATE 23, 15, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(19, 15, 51, 5, "³")
END SUB

SUB MESSAGE.4
	LOCATE 19, 15, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 20, 15, 0: PRINT "³ Enter the minimum space allowed in Kilo Bytes.  ³";
	LOCATE 21, 15, 0: PRINT "³ The system will start deleting the least used   ³";
	LOCATE 22, 15, 0: PRINT "³ files after reaching this number.               ³";
	LOCATE 23, 15, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(19, 15, 51, 5, "³")
END SUB

SUB MESSAGE.5
	COLOR 15, 4
	LOCATE 22, 22, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 23, 22, 0: PRINT "³ ÄÄÙ - Accept         ESC - Exit ³";
	LOCATE 24, 22, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(22, 22, 36, 3, "³")
END SUB

SUB MESSAGE.6
	COLOR 15, 0
	LOCATE 25, 1, 0
	PRINT "Enter new password again for verification !";
END SUB

SUB MESSAGE.7
	COLOR 15, 4
	LOCATE 17, 15, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 18, 15, 0: PRINT "³                                                 ³";
	LOCATE 19, 15, 0: PRINT "³ Space Bar - Select   ÄÄÙ - Accept   ESC - Exit ³";
	LOCATE 20, 15, 0: PRINT "³                                                 ³";
	LOCATE 21, 15, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(17, 15, 51, 5, "³")
END SUB

SUB MESSAGE.8
	LOCATE 19, 15, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 20, 15, 0: PRINT "³ This parameter allows the user to define the    ³";
	LOCATE 21, 15, 0: PRINT "³ external drive parameters. The external drive is³";
	LOCATE 22, 15, 0: PRINT "³ used to store the received formats.             ³";
	LOCATE 23, 15, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(19, 15, 51, 5, "³")
END SUB

SUB MESSAGE.9
	LOCATE 19, 14, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
	LOCATE 20, 14, 0: PRINT "³  Enter the external drive id followed by the      ³";
	LOCATE 21, 14, 0: PRINT "³  direcory id. A ':' has to follow the drive id.   ³";
	LOCATE 22, 14, 0: PRINT "³  The directory id is optional. The system will    ³";
	LOCATE 23, 14, 0: PRINT "³  copy the formats from RAM drive to this drive.   ³";
	LOCATE 24, 14, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(19, 14, 53, 6, "³")
END SUB

SUB PAINT.SCREEN

	CLS
	COLOR 15, 0
	S$ = STRING$(80, CHR$(178))
	FOR I = 1 TO 24
	   LOCATE I, 1, 0
	   PRINT S$;
	NEXT I
	COLOR 15, 9
	LOCATE 1, 1, 0: PRINT "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿"
	LOCATE 2, 1, 0: PRINT "³                       Client Screen Manager v.1.0                            ³"
	LOCATE 3, 1, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ"
	COLOR 15, 0
	LOCATE 6, 5, 0: PRINT "±±±±±";
	LOCATE 6, 14, 0: PRINT "±±±±±";
	LOCATE 6, 24, 0: PRINT "±±";
	LOCATE 6, 28, 0: PRINT "±±";
	LOCATE 6, 33, 0: PRINT "±±±±±±±";
	LOCATE 6, 43, 0: PRINT "±±";
	LOCATE 6, 48, 0: PRINT "±±";
	LOCATE 6, 54, 0: PRINT "±±±±±±";
	LOCATE 6, 63, 0: PRINT "±±±±±±";
	LOCATE 6, 74, 0: PRINT "±±";
	LOCATE 6, 78, 0: PRINT "±±";
	LOCATE 7, 9, 0: PRINT "±";
	LOCATE 7, 18, 0: PRINT "±";
	LOCATE 7, 25, 0: PRINT "±";
	LOCATE 7, 29, 0: PRINT "±";
	LOCATE 7, 39, 0: PRINT "±";
	LOCATE 7, 44, 0: PRINT "±";
	LOCATE 7, 49, 0: PRINT "±";
	LOCATE 7, 59, 0: PRINT "±";
	LOCATE 7, 68, 0: PRINT "±";
	LOCATE 7, 75, 0: PRINT "±";
	LOCATE 7, 79, 0: PRINT "±";
	LOCATE 8, 5, 0: PRINT "±";
	LOCATE 8, 14, 0: PRINT "±";
	LOCATE 8, 19, 0: PRINT "±";
	LOCATE 8, 25, 0: PRINT "±";
	LOCATE 8, 29, 0: PRINT "±";
	LOCATE 8, 35, 0: PRINT "±";
	LOCATE 8, 45, 0: PRINT "±";
	LOCATE 8, 49, 0: PRINT "±";
	LOCATE 8, 57, 0: PRINT "±";
	LOCATE 8, 65, 0: PRINT "±";
	LOCATE 8, 69, 0: PRINT "±";
	LOCATE 8, 75, 0: PRINT "±";
	LOCATE 8, 79, 0: PRINT "±";
	LOCATE 9, 4, 0: PRINT "±";
	LOCATE 9, 14, 0: PRINT "±";
	LOCATE 9, 19, 0: PRINT "±";
	LOCATE 9, 25, 0: PRINT "±";
	LOCATE 9, 29, 0: PRINT "±";
	LOCATE 9, 35, 0: PRINT "±±±";
	LOCATE 9, 46, 0: PRINT "±";
	LOCATE 9, 49, 0: PRINT "±";
	LOCATE 9, 57, 0: PRINT "±";
	LOCATE 9, 65, 0: PRINT "±";
	LOCATE 9, 69, 0: PRINT "±";
	LOCATE 9, 75, 0: PRINT "±";
	LOCATE 9, 79, 0: PRINT "±";
	LOCATE 10, 4, 0: PRINT "±";
	LOCATE 10, 14, 0: PRINT "±";
	LOCATE 10, 19, 0: PRINT "±";
	LOCATE 10, 25, 0: PRINT "±";
	LOCATE 10, 29, 0: PRINT "±";
	LOCATE 10, 37, 0: PRINT "±";
	LOCATE 10, 49, 0: PRINT "±";
	LOCATE 10, 57, 0: PRINT "±";
	LOCATE 10, 68, 0: PRINT "±";
	LOCATE 10, 78, 0: PRINT "±";
	LOCATE 11, 4, 0: PRINT "±";
	LOCATE 11, 9, 0: PRINT "±";
	LOCATE 11, 14, 0: PRINT "±";
	LOCATE 11, 19, 0: PRINT "±";
	LOCATE 11, 25, 0: PRINT "±";
	LOCATE 11, 26, 0: PRINT "±";
	LOCATE 11, 29, 0: PRINT "±";
	LOCATE 11, 35, 0: PRINT "±";
	LOCATE 11, 39, 0: PRINT "±";
	LOCATE 11, 44, 0: PRINT "±";
	LOCATE 11, 49, 0: PRINT "±";
	LOCATE 11, 57, 0: PRINT "±";
	LOCATE 11, 67, 0: PRINT "±";
	LOCATE 11, 77, 0: PRINT "±";
	LOCATE 12, 5, 0: PRINT "±±±";
	LOCATE 12, 9, 0: PRINT "±";
	LOCATE 12, 14, 0: PRINT "±±±";
	LOCATE 12, 19, 0: PRINT "±";
	LOCATE 12, 28, 0: PRINT "±";
	LOCATE 12, 35, 0: PRINT "±±±";
	LOCATE 12, 39, 0: PRINT "±";
	LOCATE 12, 44, 0: PRINT "±";
	LOCATE 12, 49, 0: PRINT "±";
	LOCATE 12, 57, 0: PRINT "±±";
	LOCATE 12, 65, 0: PRINT "±";
	LOCATE 12, 68, 0: PRINT "±";
	LOCATE 12, 77, 0: PRINT "±";
	LOCATE 13, 18, 0: PRINT "±";
	LOCATE 13, 27, 0: PRINT "±";
	LOCATE 13, 65, 0: PRINT "±";
	LOCATE 13, 69, 0: PRINT "±";
	LOCATE 13, 78, 0: PRINT "±";
	LOCATE 16, 19, 0: PRINT "±±±±±";
	LOCATE 16, 27, 0: PRINT "±±±±±±";
	LOCATE 16, 38, 0: PRINT "±±±±±";
	LOCATE 16, 48, 0: PRINT "±±";
	LOCATE 16, 52, 0: PRINT "±±";
	LOCATE 16, 57, 0: PRINT "±±±±±±";
	LOCATE 17, 23, 0: PRINT "±";
	LOCATE 17, 32, 0: PRINT "±";
	LOCATE 17, 42, 0: PRINT "±";
	LOCATE 17, 49, 0: PRINT "±";
	LOCATE 17, 53, 0: PRINT "±";
	LOCATE 17, 62, 0: PRINT "±±";
	LOCATE 18, 19, 0: PRINT "±";
	LOCATE 18, 29, 0: PRINT "±";
	LOCATE 18, 33, 0: PRINT "±";
	LOCATE 18, 38, 0: PRINT "±";
	LOCATE 18, 43, 0: PRINT "±";
	LOCATE 18, 49, 0: PRINT "±";
	LOCATE 18, 53, 0: PRINT "±";
	LOCATE 18, 59, 0: PRINT "±";
	LOCATE 18, 63, 0: PRINT "±";
	LOCATE 19, 18, 0: PRINT "±";
	LOCATE 19, 29, 0: PRINT "±";
	LOCATE 19, 33, 0: PRINT "±";
	LOCATE 19, 38, 0: PRINT "±";
	LOCATE 19, 43, 0: PRINT "±";
	LOCATE 19, 49, 0: PRINT "±";
	LOCATE 19, 53, 0: PRINT "±";
	LOCATE 19, 59, 0: PRINT "±±";
	LOCATE 19, 63, 0: PRINT "±";
	LOCATE 20, 18, 0: PRINT "±";
	LOCATE 20, 21, 0: PRINT "±±±";
	LOCATE 20, 32, 0: PRINT "±";
	LOCATE 20, 38, 0: PRINT "±";
	LOCATE 20, 43, 0: PRINT "±";
	LOCATE 20, 49, 0: PRINT "±";
	LOCATE 20, 53, 0: PRINT "±";
	LOCATE 20, 62, 0: PRINT "±";
	LOCATE 21, 18, 0: PRINT "±";
	LOCATE 21, 23, 0: PRINT "±";
	LOCATE 21, 31, 0: PRINT "±";
	LOCATE 21, 38, 0: PRINT "±";
	LOCATE 21, 43, 0: PRINT "±";
	LOCATE 21, 49, 0: PRINT "±";
	LOCATE 21, 53, 0: PRINT "±";
	LOCATE 21, 59, 0: PRINT "±";
	LOCATE 22, 19, 0: PRINT "±±";
	LOCATE 22, 23, 0: PRINT "±";
	LOCATE 22, 29, 0: PRINT "±";
	LOCATE 22, 32, 0: PRINT "±";
	LOCATE 22, 38, 0: PRINT "±±±";
	LOCATE 22, 43, 0: PRINT "±";
	LOCATE 22, 49, 0: PRINT "±±";
	LOCATE 22, 53, 0: PRINT "±";
	LOCATE 22, 59, 0: PRINT "±";
	LOCATE 23, 29, 0: PRINT "±";
	LOCATE 23, 33, 0: PRINT "±";
	LOCATE 23, 42, 0: PRINT "±";
	LOCATE 23, 52, 0: PRINT "±";
	LOCATE 23, 59, 0: PRINT "±";

	COLOR 4, 15

	LOCATE 7, 4, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 7, 13, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 7, 23, 0: PRINT "ÛÛ";
	LOCATE 7, 27, 0: PRINT "ÛÛ";
	LOCATE 7, 32, 0: PRINT "ÛÛÛÛÛÛÛ";
	LOCATE 7, 42, 0: PRINT "ÛÛ";
	LOCATE 7, 47, 0: PRINT "ÛÛ";
	LOCATE 7, 53, 0: PRINT "ÛÛÛÛÛÛ";
	LOCATE 7, 62, 0: PRINT "ÛÛÛÛÛÛ";
	LOCATE 7, 73, 0: PRINT "ÛÛ";
	LOCATE 7, 77, 0: PRINT "ÛÛ";
	LOCATE 8, 3, 0: PRINT "ÛÛ";
	LOCATE 8, 8, 0: PRINT "Û";
	LOCATE 8, 12, 0: PRINT "ÛÛ";
	LOCATE 8, 17, 0: PRINT "ÛÛ";
	LOCATE 8, 23, 0: PRINT "ÛÛ";
	LOCATE 8, 27, 0: PRINT "ÛÛ";
	LOCATE 8, 33, 0: PRINT "ÛÛ";
	LOCATE 8, 38, 0: PRINT "Û";
	LOCATE 8, 42, 0: PRINT "ÛÛÛ";
	LOCATE 8, 47, 0: PRINT "ÛÛ";
	LOCATE 8, 53, 0: PRINT "Û";
	LOCATE 8, 55, 0: PRINT "ÛÛ";
	LOCATE 8, 58, 0: PRINT "Û";
	LOCATE 8, 63, 0: PRINT "ÛÛ";
	LOCATE 8, 67, 0: PRINT "ÛÛ";
	LOCATE 8, 73, 0: PRINT "ÛÛ";
	LOCATE 8, 77, 0: PRINT "ÛÛ";
	LOCATE 9, 2, 0: PRINT "ÛÛ";
	LOCATE 9, 12, 0: PRINT "ÛÛ";
	LOCATE 9, 17, 0: PRINT "ÛÛ";
	LOCATE 9, 23, 0: PRINT "ÛÛ";
	LOCATE 9, 27, 0: PRINT "ÛÛ";
	LOCATE 9, 33, 0: PRINT "ÛÛ";
	LOCATE 9, 42, 0: PRINT "ÛÛÛÛ";
	LOCATE 9, 47, 0: PRINT "ÛÛ";
	LOCATE 9, 55, 0: PRINT "ÛÛ";
	LOCATE 9, 63, 0: PRINT "ÛÛ";
	LOCATE 9, 67, 0: PRINT "Û";
	LOCATE 9, 68, 0: PRINT "Û";
	LOCATE 9, 73, 0: PRINT "Û";
	LOCATE 9, 74, 0: PRINT "Û";
	LOCATE 9, 77, 0: PRINT "Û";
	LOCATE 9, 78, 0: PRINT "Û";
	LOCATE 10, 2, 0: PRINT "ÛÛ";
	LOCATE 10, 12, 0: PRINT "ÛÛ";
	LOCATE 10, 17, 0: PRINT "ÛÛ";
	LOCATE 10, 23, 0: PRINT "ÛÛ";
	LOCATE 10, 27, 0: PRINT "ÛÛ";
	LOCATE 10, 33, 0: PRINT "ÛÛÛÛ";
	LOCATE 10, 42, 0: PRINT "ÛÛÛÛÛÛÛ";
	LOCATE 10, 55, 0: PRINT "ÛÛ";
	LOCATE 10, 63, 0: PRINT "ÛÛÛÛÛÛ";
	LOCATE 10, 74, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 11, 2, 0: PRINT "ÛÛ";
	LOCATE 11, 12, 0: PRINT "ÛÛ";
	LOCATE 11, 17, 0: PRINT "ÛÛ";
	LOCATE 11, 23, 0: PRINT "ÛÛ";
	LOCATE 11, 27, 0: PRINT "ÛÛ";
	LOCATE 11, 33, 0: PRINT "ÛÛ";
	LOCATE 11, 42, 0: PRINT "ÛÛ";
	LOCATE 11, 45, 0: PRINT "ÛÛÛÛ";
	LOCATE 11, 55, 0: PRINT "ÛÛ";
	LOCATE 11, 63, 0: PRINT "ÛÛÛÛ";
	LOCATE 11, 75, 0: PRINT "ÛÛ";
	LOCATE 12, 3, 0: PRINT "ÛÛ";
	LOCATE 12, 8, 0: PRINT "Û";
	LOCATE 12, 12, 0: PRINT "ÛÛ";
	LOCATE 12, 17, 0: PRINT "ÛÛ";
	LOCATE 12, 24, 0: PRINT "ÛÛÛÛ";
	LOCATE 12, 33, 0: PRINT "ÛÛ";
	LOCATE 12, 38, 0: PRINT "Û";
	LOCATE 12, 42, 0: PRINT "ÛÛ";
	LOCATE 12, 46, 0: PRINT "ÛÛÛ";
	LOCATE 12, 55, 0: PRINT "ÛÛ";
	LOCATE 12, 63, 0: PRINT "ÛÛ";
	LOCATE 12, 66, 0: PRINT "ÛÛ";
	LOCATE 12, 75, 0: PRINT "ÛÛ";
	LOCATE 13, 4, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 13, 13, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 13, 25, 0: PRINT "ÛÛ";
	LOCATE 13, 32, 0: PRINT "ÛÛÛÛÛÛÛ";
	LOCATE 13, 42, 0: PRINT "ÛÛ";
	LOCATE 13, 47, 0: PRINT "ÛÛ";
	LOCATE 13, 54, 0: PRINT "ÛÛÛÛ";
	LOCATE 13, 62, 0: PRINT "ÛÛÛ";
	LOCATE 13, 67, 0: PRINT "ÛÛ";
	LOCATE 13, 74, 0: PRINT "ÛÛÛÛ";
	LOCATE 17, 18, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 17, 26, 0: PRINT "ÛÛÛÛÛÛ";
	LOCATE 17, 37, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 17, 47, 0: PRINT "ÛÛ";
	LOCATE 17, 51, 0: PRINT "ÛÛ";
	LOCATE 17, 56, 0: PRINT "ÛÛÛÛÛÛ";
	LOCATE 18, 17, 0: PRINT "ÛÛ";
	LOCATE 18, 22, 0: PRINT "Û";
	LOCATE 18, 27, 0: PRINT "ÛÛ";
	LOCATE 18, 31, 0: PRINT "ÛÛ";
	LOCATE 18, 36, 0: PRINT "ÛÛ";
	LOCATE 18, 41, 0: PRINT "ÛÛ";
	LOCATE 18, 47, 0: PRINT "ÛÛ";
	LOCATE 18, 51, 0: PRINT "ÛÛ";
	LOCATE 18, 57, 0: PRINT "ÛÛ";
	LOCATE 18, 61, 0: PRINT "ÛÛ";
	LOCATE 19, 16, 0: PRINT "ÛÛ";
	LOCATE 19, 27, 0: PRINT "ÛÛ";
	LOCATE 19, 31, 0: PRINT "ÛÛ";
	LOCATE 19, 36, 0: PRINT "ÛÛ";
	LOCATE 19, 41, 0: PRINT "ÛÛ";
	LOCATE 19, 47, 0: PRINT "ÛÛ";
	LOCATE 19, 51, 0: PRINT "ÛÛ";
	LOCATE 19, 57, 0: PRINT "ÛÛ";
	LOCATE 19, 61, 0: PRINT "ÛÛ";
	LOCATE 20, 16, 0: PRINT "ÛÛ";
	LOCATE 20, 27, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 20, 36, 0: PRINT "ÛÛ";
	LOCATE 20, 41, 0: PRINT "ÛÛ";
	LOCATE 20, 47, 0: PRINT "ÛÛ";
	LOCATE 20, 51, 0: PRINT "ÛÛ";
	LOCATE 20, 57, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 21, 16, 0: PRINT "ÛÛ";
	LOCATE 21, 20, 0: PRINT "ÛÛÛ";
	LOCATE 21, 27, 0: PRINT "ÛÛÛÛ";
	LOCATE 21, 36, 0: PRINT "ÛÛ";
	LOCATE 21, 41, 0: PRINT "ÛÛ";
	LOCATE 21, 47, 0: PRINT "ÛÛ";
	LOCATE 21, 51, 0: PRINT "ÛÛ";
	LOCATE 21, 57, 0: PRINT "ÛÛ";
	LOCATE 22, 17, 0: PRINT "ÛÛ";
	LOCATE 22, 21, 0: PRINT "ÛÛ";
	LOCATE 22, 27, 0: PRINT "ÛÛ";
	LOCATE 22, 30, 0: PRINT "ÛÛ";
	LOCATE 22, 36, 0: PRINT "ÛÛ";
	LOCATE 22, 41, 0: PRINT "ÛÛ";
	LOCATE 22, 47, 0: PRINT "ÛÛ";
	LOCATE 22, 51, 0: PRINT "ÛÛ";
	LOCATE 22, 57, 0: PRINT "ÛÛ";
	LOCATE 23, 18, 0: PRINT "ÛÛ";
	LOCATE 23, 20, 0: PRINT "ÛÛÛ";
	LOCATE 23, 26, 0: PRINT "ÛÛÛ";
	LOCATE 23, 31, 0: PRINT "ÛÛ";
	LOCATE 23, 37, 0: PRINT "ÛÛÛÛÛ";
	LOCATE 23, 48, 0: PRINT "ÛÛÛÛ";
	LOCATE 23, 56, 0: PRINT "ÛÛÛ";
END SUB

SUB PARITY.WINDOW
	LOCATE 10, 47, 0: PRINT "ÚÄParityÄ¿";
	LOCATE 11, 47, 0: PRINT "³        ³";
	LOCATE 12, 47, 0: PRINT "³        ³";
	LOCATE 13, 47, 0: PRINT "³        ³";
	LOCATE 14, 47, 0: PRINT "ÀÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(10, 47, 10, 5, "³")
END SUB

SUB PASSWORD.SCREEN
	COLOR 15, 1
	LOCATE 9, 30, 0: PRINT "ÚÄÄÄOld PasswordÄÄÄÄ¿";
	LOCATE 10, 30, 0: PRINT "³         :         ³";
	LOCATE 11, 30, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(9, 30, 21, 3, "³")
	LOCATE 13, 30, 0: PRINT "ÚÄÄÄNew PasswordÄÄÄÄ¿";
	LOCATE 14, 30, 0: PRINT "³         :         ³";
	LOCATE 15, 30, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(13, 30, 21, 3, "³")
END SUB

SUB PORT.WINDOW
	LOCATE 10, 47, 0: PRINT "ÚÄPortÄ¿";
	LOCATE 11, 47, 0: PRINT "³      ³";
	LOCATE 12, 47, 0: PRINT "³      ³";
	LOCATE 13, 47, 0: PRINT "ÀÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(10, 47, 8, 4, "³")
END SUB

SUB PRINTER.PORT.WINDOW
	LOCATE 10, 47, 0: PRINT "ÚÄPrinter PortÄ¿";
	LOCATE 11, 47, 0: PRINT "³              ³";
	LOCATE 12, 47, 0: PRINT "³              ³";
	LOCATE 13, 47, 0: PRINT "³              ³";
	LOCATE 14, 47, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(10, 47, 16, 5, "³")
END SUB

SUB PUT.SHADOW (XS%, YS%, LS%, DS%, C$)

	LOCATE XS% - 2, YS% + 1, 0
        CALL PUTSHADOW(LS%, 1)
	LOCATE XS% - 1, YS% + LS% - 2, 0
        CALL PUTSHADOW(2, DS% - 1)
	LOCATE XS% - 1, YS% + LS% - 1, 0
        CALL PUTSHADOW(2, DS% - 1)
	LOCATE XS% + DS% - 2, YS% + LS% - 1, 0: PRINT C$;

END SUB

SUB SAVE.AFKEYS.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º Save ALT F-KEYS changes(Y/N)?     º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.AUTO.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º Save AutoStart changes (Y/N) ?    º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.CFKEYS.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º Save CTRL F-KEYS changes(Y/N)?    º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.COLORS.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º    Save screen options (Y/N) ?    º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.COMMS.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º    Save Comms changes (Y/N) ?     º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.DISK.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º    Save Disk changes (Y/N) ?      º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.FKEYS.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º    Save F-KEYS changes (Y/N) ?    º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SAVE.SFKEYS.MESSAGE
	LOCATE 12, 23, 0: PRINT "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»";
	LOCATE 13, 23, 0: PRINT "º Save SHIFT F-KEYS changes(Y/N)?   º";
	LOCATE 14, 23, 0: PRINT "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼";
	CALL PUT.SHADOW(12, 23, 37, 3, "º")
END SUB

SUB SPEED.WINDOW
	LOCATE 10, 47, 0: PRINT "ÚÄSpeedÄ¿";
	FOR J = 11 TO 20
	   LOCATE J, 47, 0: PRINT "³       ³";
	NEXT J
	LOCATE 21, 47, 0: PRINT "ÀÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(10, 47, 9, 12, "³")
END SUB

SUB STOP.BITS.WINDOW
	LOCATE 10, 47, 0: PRINT "ÚÄStop Bits¿";
	LOCATE 11, 47, 0: PRINT "³          ³";
	LOCATE 12, 47, 0: PRINT "³          ³";
	LOCATE 13, 47, 0: PRINT "ÀÄÄÄÄÄÄÄÄÄÄÙ";
	CALL PUT.SHADOW(10, 47, 12, 4, "³")
END SUB

SUB STORE.COLORS (CONFIG.INDEX, CONFIG.LINES$(), STORED.COLORS$(), DISPLAY.MODE$)
	FOR I = 1 TO 6
	   FOR J = 1 TO CONFIG.INDEX
	      A$ = CONFIG.LINES$(J)
	      IF LEFT$(A$, 1) <> "*" THEN
		 SELECT CASE I
		    CASE 1
		       IF LEFT$(A$, 13) = "BACKGROUND  =" THEN
			  CONFIG.LINES$(J) = "BACKGROUND  = " + STORED.COLORS$(I)
			  J = 101
		       END IF
		    CASE 2
		       IF LEFT$(A$, 13) = "NORMAL      =" THEN
			  CONFIG.LINES$(J) = "NORMAL      = " + STORED.COLORS$(I)
			  J = 101
		       END IF
		    CASE 3
		       IF LEFT$(A$, 13) = "UNPROTECTED =" THEN
			  CONFIG.LINES$(J) = "UNPROTECTED = " + STORED.COLORS$(I)
			  J = 101
		       END IF
		    CASE 4
		       IF LEFT$(A$, 13) = "BLINK       =" THEN
			  CONFIG.LINES$(J) = "BLINK       = " + STORED.COLORS$(I)
			  J = 101
		       END IF
		    CASE 5
		       IF LEFT$(A$, 13) = "DIM         =" THEN
			  CONFIG.LINES$(J) = "DIM         = " + STORED.COLORS$(I)
			  J = 101
		       END IF
		    CASE 6
		       IF LEFT$(A$, 13) = "DISP.MODE   =" THEN
			  CONFIG.LINES$(J) = "DISP.MODE   = " + DISPLAY.MODE$
			  J = 101
		       END IF
		 END SELECT
	      END IF
	   NEXT J
	NEXT I
END SUB

SUB STORE.COMMS (PORT$, SPEED$, PARITY$, DATA.SIZE$, STOP.BITS$, PRN.PORT$, PRN.ENABLE$, PRN.DISABLE$, P.SPEED$, P.DATA$, P.PARITY$, P.STOP$, CONFIG.INDEX, CONFIG.LINES$(), TIME.OUT$)
	FOR J = 1 TO CONFIG.INDEX
	   A$ = CONFIG.LINES$(J)
	   IF LEFT$(A$, 1) <> "*" THEN
	      SELECT CASE LEFT$(A$, 13)
		 CASE "PORT        ="
		    A$ = "PORT        = " + PORT$ + ":"
		    A$ = A$ + SPEED$ + ","
		    A$ = A$ + LEFT$(PARITY$, 1) + ","
		    A$ = A$ + DATA.SIZE$ + ","
		    A$ = A$ + STOP.BITS$
		 CASE "PRN.PORT    ="
		    IF LEFT$(PRN.PORT$, 3) = "COM" THEN
		       A$ = "PRN.PORT    = " + PRN.PORT$ + ":" + P.SPEED$ + ","
		       A$ = A$ + P.PARITY$ + ","
		       A$ = A$ + P.DATA$ + ","
		       A$ = A$ + P.STOP$
		    ELSE
		       A$ = "PRN.PORT    = " + PRN.PORT$
		    END IF
                 CASE "TIME.OUT    ="
                    A$ = "TIME.OUT    = " + TIME.OUT$
		 CASE "PRN.ENABLE  ="
		    A$ = "PRN.ENABLE  = " + PRN.ENABLE$
		 CASE "PRN.DISABLE ="
		    A$ = "PRN.DISABLE = " + PRN.DISABLE$
	      END SELECT
	      CONFIG.LINES$(J) = A$
	   END IF
	NEXT J
END SUB

SUB STORE.DISK (CONFIG.INDEX, CONFIG.LINES$(), RAM.DRIVE$, MIN.SPACE$, EXT.DRIVE$, EXT.MIN.SP$, R.FREQ$, EXT.ENABLE$)
	FOR J = 1 TO CONFIG.INDEX
	   A$ = CONFIG.LINES$(J)
	   IF LEFT$(A$, 1) <> "*" THEN
	      SELECT CASE LEFT$(A$, 13)
		 CASE "RAM.DRIVE   ="
		    A$ = "RAM.DRIVE   = " + RAM.DRIVE$
		 CASE "MIN.SPACE   ="
		    A$ = "MIN.SPACE   = " + MIN.SPACE$
		 CASE "EXT.DRIVE   ="
		    A$ = "EXT.DRIVE   = " + EXT.DRIVE$
		 CASE "EXT.MIN.SP  ="
		    A$ = "EXT.MIN.SP  = " + EXT.MIN.SP$
		 CASE "REFRESH     ="
		    A$ = "REFRESH     = " + R.FREQ$
		 CASE "EXT.ENABLE  ="
		    A$ = "EXT.ENABLE  = " + EXT.ENABLE$
	      END SELECT
	      CONFIG.LINES$(J) = A$
	   END IF
	NEXT J
END SUB

SUB WRITE.CONFIG.FILE (CONFIG.LINES$(), CONFIG.INDEX)

	OPEN "SCR-MNGR.INI" FOR OUTPUT AS #1
	FOR I = 1 TO CONFIG.INDEX
	   PRINT #1, CONFIG.LINES$(I)
	NEXT I
	CLOSE #1
END SUB

SUB VIDEO.CHECK (C.SCREEN)
SHARED ERROR.CODE
SHARED ERR.ROUTINE$

	ERR.ROUTINE$ = "VIDEO.CHECK"
	ON ERROR GOTO VIDEO.ERROR.ROUTINE
	ERROR.CODE = 0
	FOR I = 0 TO 100
	   SCREEN , , I, I
	   IF ERROR.CODE = 5 THEN
	      C.SCREEN = I - 2
	      SCREEN , , 0, 0
	      EXIT SUB
	   END IF
	NEXT I
	C.SCREEN = I - 2
	SCREEN , , 0, 0
END SUB

SUB PRINT.P.PARAMETERS(P.SPEED$, P.PARITY$, P.DATA$, P.STOP$)
        COLOR 15, 1
        IF P.SPEED$ = "" THEN P.SPEED$ = "9600"
        IF P.PARITY$ = "" THEN P.PARITY$ = "O"
        IF P.DATA$ = "" THEN P.DATA$ = "8"
        IF P.STOP$ = "" THEN P.STOP$ = "1"
        LOCATE 19, 43, 0: PRINT P.SPEED$;
        LOCATE 19, 54, 0: PRINT P.DATA$;
        LOCATE 19, 63, 0: PRINT P.PARITY$;
        LOCATE 19, 70, 0: PRINT P.STOP$;
END SUB
